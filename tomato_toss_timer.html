<label for="minTimeDropdown">Select minimum time:</label>
<select id="minTimeDropdown">
    <option value="5">5 seconds</option>
    <option value="10">10 seconds</option>
    <option value="30">30 seconds</option>
    <option value="60">1 minute</option>
    <option value="300" selected>5 minutes</option>
    <option value="600">10 minutes</option>
    <option value="1800">30 minutes</option>
    <option value="3600">1 hour</option>
</select>

<label for="maxTimeDropdown">Select maximum time:</label>
<select id="maxTimeDropdown">
    <option value="10">10 seconds</option>
    <option value="30">30 seconds</option>
    <option value="60">1 minute</option>
    <option value="300">5 minutes</option>
    <option value="600">10 minutes</option>
    <option value="1800" selected>30 minutes</option>
    <option value="3600">1 hour</option>
</select>

<br>

<label for="urlInput">Enter custom URL:</label>
<input type="text" id="urlInput" value="https://www.youtube.com/watch?v=v7IIi-ETL7U">
<button id="clearURLButton">Clear URL</button>

<br>

<button id="startButton">Start Timer</button>
<button id="pauseButton">Pause</button>
<button id="resetButton">Reset</button>
<button id="toggleDisplayButton">Hide Countdown</button>

<div id="statusIndicator" style="font-weight: bold;"></div>
<div id="timer"></div>
<div id="errorMessage" style="color: red;"></div>

<script>
    const timerDisplay = document.getElementById('timer');
    const statusIndicator = document.getElementById('statusIndicator');
    const minTimeDropdown = document.getElementById('minTimeDropdown');
    const maxTimeDropdown = document.getElementById('maxTimeDropdown');
    const urlInput = document.getElementById('urlInput');
    const clearURLButton = document.getElementById('clearURLButton');
    const startButton = document.getElementById('startButton');
    const pauseButton = document.getElementById('pauseButton');
    const resetButton = document.getElementById('resetButton');
    const toggleDisplayButton = document.getElementById('toggleDisplayButton');
    const errorMessage = document.getElementById('errorMessage');

    let countdown;
    let isPaused = false;
    let isHidden = false;

    function isValidURL(string) {
        const res = string.match(/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)?$/);
        return (res !== null);
    };

    function updateStatusIndicator() {
        if (countdown && !isPaused) {
            statusIndicator.textContent = 'TIMER RUNNING';
            statusIndicator.style.color = 'red';
        } else {
            statusIndicator.textContent = 'TIMER STOPPED';
            statusIndicator.style.color = 'black';
        }
    }

    // Initial state
    updateStatusIndicator();

    // Clear the URL input field
    clearURLButton.addEventListener('click', function() {
        urlInput.value = '';
    });

    // Toggle the visibility of the countdown display
    toggleDisplayButton.addEventListener('click', function() {
        if (isHidden) {
            timerDisplay.style.display = "block";
            toggleDisplayButton.textContent = "Hide Countdown";
            isHidden = false;
        } else {
            timerDisplay.style.display = "none";
            toggleDisplayButton.textContent = "Show Countdown";
            isHidden = true;
        }
    });

    startButton.addEventListener('click', function() {
        errorMessage.textContent = ''; // Clear previous error messages

        if (!isValidURL(urlInput.value)) {
            errorMessage.textContent = 'Please enter a valid URL.';
            return;
        }

        if (countdown) {
            clearInterval(countdown);
        }

        const minTime = parseInt(minTimeDropdown.value, 10);
        const maxTime = parseInt(maxTimeDropdown.value, 10);
        if (minTime >= maxTime) {
            errorMessage.textContent = 'Minimum time should be less than maximum time.';
            return;
        }
        const randomTime = Math.floor(Math.random() * (maxTime - minTime + 1) + minTime);
        let totalSeconds = randomTime;
        isPaused = false;

        // Start the timer
        countdown = setInterval(() => {
            if (totalSeconds <= 0) {
                clearInterval(countdown);
                timerDisplay.textContent = '0';
                timerDisplay.style.animation = 'blink 1s infinite';
                statusIndicator.textContent = 'TIME UP';
                statusIndicator.style.color = 'red';
                
                const urlToOpen = urlInput.value || 'https://www.example.com';
                window.open(urlToOpen, '_blank');
            } else {
                timerDisplay.style.animation = ''; // Reset the blink animation
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = totalSeconds % 60;
                timerDisplay.textContent = `${minutes} minutes ${seconds} seconds left`;
                totalSeconds--;
            }
        }, 1000);
        updateStatusIndicator();
    });

    pauseButton.addEventListener('click', function() {
        if (!isPaused) {
            clearInterval(countdown);
            countdown = null; // Ensure the timer is considered as stopped
            pauseButton.textContent = "Resume";
            isPaused = true;
            updateStatusIndicator();
        } else {
            isPaused = false;
            startButton.click(); // Reuse the start function to continue from the current time
        }
    });

    resetButton.addEventListener('click', function() {
        clearInterval(countdown);
        countdown = null; // Ensure the timer is considered as stopped
        timerDisplay.textContent = '';
        timerDisplay.style.animation = ''; // Reset the blink animation
        minTimeDropdown.value = "300";
        maxTimeDropdown.value = "1800";
        pauseButton.textContent = "Pause";
        isPaused = false;
        updateStatusIndicator();
    });

</script>

</body>
</html>
